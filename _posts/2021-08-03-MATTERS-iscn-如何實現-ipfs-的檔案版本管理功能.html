---
layout: post
title: ISCN 如何實現 IPFS 的檔案版本管理功能
date: 2021-08-03 01:07:47.000000000 +00:00
link: https://matters.news/@likecoin/iscn-%E5%A6%82%E4%BD%95%E5%AF%A6%E7%8F%BE-ipfs-%E7%9A%84%E6%AA%94%E6%A1%88%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86%E5%8A%9F%E8%83%BD-bafyreihhc2kyofyfaoeamlzz3krlqd4b5uedjkzr666fj2d6noqgecoyra
categories: matters
tags: blog
author: 讚賞公民共和國
---

<p>IPFS 的內容指紋是檔案的獨特記號，可用來判斷兩個檔案是否完全相同。假如檔案被改動了，那怕只是增刪一個像素，內容指紋哈希 (hash) 也會完全不同。這特性讓用戶能簡單驗證內容是否原版，有否被竄改過。這是 IPFS 的重要特色。</p><p>舉例，以下兩串內容指紋指向的兩個檔案內容只相差一個空格，指紋卻完全不同。</p><p>原版本： <a href="https://gateway.pinata.cloud/ipfs/QmQPzjhk9Eqy7vJWhaheyg4NiBxAz51WXUTsx92STBTs1j" target="_blank">QmQPzjhk9Eqy7vJWhaheyg4NiBxAz51WXUTsx92STBTs1j</a></p><p>新版本（多一個空格）： <a href="https://gateway.pinata.cloud/ipfs/QmQPzjhk9Eqy7vJWhaheyg4NiBxAz51WXUTsx92STBTs1j" target="_blank">QmTQ6xEFKFSvRTxncf46CvYQf1rnRnfduKM7VepKyGo3LR</a></p><p>然而這帶來一個問題。假設有人把<a href="https://infura-ipfs.io/ipfs/Qmf7sAjTjynnuxWaz6bgXiRLrQHzyQj94eBjjBiKpcFtax" target="_blank">某條重要的影片</a>備份了到 IPFS 網絡，某天他找到同一條影片的高清版，想把它更新到 IPFS。由於新版本影片產生了另一個內容指紋，而 IPFS 上檔案的網址是以內容指紋構成的，於是不同的檔案版本便產生了不同的網址。</p><p>每次檔案更新版本後，網址也會跟著改變，這有礙資訊的流傳，因為訪問者很難追縱著新版本的網址是什麼。</p><p>IPFS 提供了一個基本方案解決以上問題： IPNS (InterPlanetary Name Service)。</p><h3>IPNS 未能完全滿足檔案版本管理需求</h3><p>IPNS 的功能是以一串固定的公開鑰匙 (public key) 地址指向可變的內容指紋版本。當檔案的版本更新了，檔案擁有者可改變 IPNS 地址指向新版本的內容指紋，令用戶訪問時直接取得新版本的檔案。IPNS public key 地址跟內容指紋同樣是一串哈希 (hash)，外貌都是一串人類不能讀懂的亂碼字串，例如：</p><p>k51qzi5uqu5di0d9ghx9d6u6b9cs537mzf74iw95ry9w6c65ptcmg0p92w21rm</p><p>用戶可以 IPNS 協議直接訪問，例如：</p><p><strong>ipns://</strong>k51qzi5uqu5di0d9ghx9d6u6b9cs537mzf74iw95ry9w6c65ptcmg0p92w21rm</p><p>或通過 <a href="https://ipfs.github.io/public-gateway-checker/" target="_blank">IPFS 公共節點</a>訪問，例如：</p><p><a href="https://gateway.pinata.cloud/ipns/" target="_blank"><strong>https://gateway.pinata.cloud/ipns/</strong></a><a href="https://gateway.pinata.cloud/ipns/k51qzi5uqu5di0d9ghx9d6u6b9cs537mzf74iw95ry9w6c65ptcmg0p92w21rm" target="_blank">k51qzi5uqu5di0d9ghx9d6u6b9cs537mzf74iw95ry9w6c65ptcmg0p92w21rm</a></p><figure class="image"><img src="https://assets.matters.news/embed/75a06ca4-83c6-4490-83c2-20c307230e3d.png" data-asset-id="75a06ca4-83c6-4490-83c2-20c307230e3d" referrerpolicy="no-referrer"><figcaption><span>以 IPNS 地址取得最新版本的 IPFS 檔案</span></figcaption></figure><p>以上方法令用戶只需記著同一個地址便可訪問到最新版本的檔案，然而卻未能完全解決檔案版本管理的需求，因除了獲得最新版本的檔案外，還有其他重要的版本功能需求。</p><p>假設現在有一份重要如香港《基本法》的法律文件在 <strong>IPFS</strong> 上發佈了，訪問者雖能通過固定的 <strong>IPNS</strong> 地址訪問到最新版本，卻無法得知過往每一個舊版本的改動，會產生什麼問題呢？市民無從得知政府過往的承諾是怎樣，無法比較過往版本來了解歷史脈落，甚至連具體修改了什麼的資訊也欠奉。</p><p>由此可見，用戶期待的版本控制功能遠比只能取得新版本的基本 name service 功能要複雜得多，因為 IPNS 的設計本不是針對版本管理需求的。</p><p>完整的版本管理功能需求，可參考軟件開發人員常用的 GitHub 服務。GitHub 的檔案版本管理功能十分齊全，對非程式碼的一般資料來說可能是殺雞用牛刀，然而我們卻可從中抽取不少有用的洞見。例如：</p><ul><li>每個版本都有獨一號碼以茲識別</li><li>包含修改記錄詳情，包括修改時間、修改內容、修改原因等</li><li>資料追溯功能： 可取得任何一個舊版本的完整資料</li></ul><h3>為 IPFS 檔建立「版本資料庫」</h3><p>管理檔案版本的直觀方法，是建立一個檔案的索引資料庫，記錄每個檔案的版本號及各種跟版本修改有關的資訊。版本的資料結構可以很基本，即每一檔案版本對應一筆記錄，內有該版本指向的檔案內容指紋，而同一內容的所有版本都分享同一個內容名稱，功用一如 IPNS，方便用戶搜尋。</p><figure class="image"><img src="https://assets.matters.news/embed/798def8e-0011-46f3-bb92-9bcfc3bfbe88.png" data-asset-id="798def8e-0011-46f3-bb92-9bcfc3bfbe88" referrerpolicy="no-referrer"><figcaption><span></span></figcaption></figure><p>這種內容版本資料結構其實早已在很多領域沿用，例如書籍的 ISBN 便以相似的方法處理再版記錄。現況卻是包括版本資訊在內的各種內容元資料正以各種不同的格式儲存在不互通的數據庫中，窒礙資訊流通；而且資料由少數機構或個人負責管理，會有被竄改的風險。這便是為何版本資訊應建立於區塊鏈的關鍵原因。</p><h3>ISCN：版本資料去中心化由公眾管理</h3><p>ISCN 是建立於 LikeCoin chain 區塊鏈上，記錄包括檔案版本資訊等元資料的功能。ISCN 中有關版本管理的資料結構很簡單：</p><ul><li>iscn:Record：每一內容都可註冊一個 ISCN ID</li><li>iscn:RecordVersion：由系統管理的版本號</li><li>iscn:ContentFingerprints：內容指紋，可以是 IPFS/IPNS hash 或任何網址</li><li>iscn:recordParentIPLD：指向上一版本的 ISCN 記錄，讓用戶能追溯舊版本檔案的資料</li></ul><figure class="image"><img src="https://assets.matters.news/embed/653ed1f0-6855-4738-bc26-84c33d610900.png" data-asset-id="653ed1f0-6855-4738-bc26-84c33d610900" referrerpolicy="no-referrer"><figcaption><span>在 iscn.io 上定義的 ISCN 數據結構</span></figcaption></figure><p>有別於把版本資訊儲存在封閉的數據庫，ISCN 把檔案版本元數據儲存在 LikeCoin chain 的區塊鏈上。鏈上資料公開透明且不可竄改，代表任何改動必留下痕跡。這對有公共意義的內容尤其重要，例如政府檔案、新聞報導、歷史記錄等。</p><p>把版本資訊寫在鏈上，等於把這基本的內容資訊管理方式由百花齊放但互不相通的應用層，下移到所有應用都能共享的協議層，有助建立內容孤島之間的橋樑。</p><p>由於區塊鏈由分散的通證持份者管理，一旦出現版本的爭議時，可藉流動民主的機制直接或授權社群代表處理。</p><p>以 ISCN 來處理 IPFS 的檔案版本，可完美解決以上提及過的版本管理問題。ISCN 的設計且不限於處理 IPFS 檔，也可用在其他分佈式檔案系統如 Arweave，或任何傳統的中心化數據庫。</p><figure class="image"><img src="https://assets.matters.news/embed/089b52a4-ff05-4b7f-9754-51bc2c0143c8.png" data-asset-id="089b52a4-ff05-4b7f-9754-51bc2c0143c8" referrerpolicy="no-referrer"><figcaption><span></span></figcaption></figure><p><br></p>
