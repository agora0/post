---
layout: post
title: å‰ç«¯ä¹Ÿè¦ææµ‹è¯• ï½ vue + vitest
date: 2022-10-09 01:33:30.000000000 +00:00
link: https://matters.news/@potato_pepper/%E5%89%8D%E7%AB%AF%E4%B9%9F%E8%A6%81%E6%90%9E%E6%B5%8B%E8%AF%95-vue-vitest-bafyreiejisgaogayuotiezuyc64ytjozx64j5glkxhosowvekrl3lcztgy
categories: matters
tags: blog
author: åœŸè±†ç‚’é’æ¤’
---

<p>å…³äº JavaScript çš„æµ‹è¯•ï¼Œå¬åˆ°æ¯”è¾ƒå¤šçš„æœ‰ jestï¼Œä½†å„çŸ¥ååšä¸»å¼ºçƒˆæ¨è vitestï¼Œäºæ˜¯æˆ‘ä¹Ÿæ¥ç©ç© vitestâ€¦â€¦</p><h2>vitest VS jest</h2><ul><li>vitest æ¯” jest å¿«ï¼Œæ›´å¤šå„ç§ powerfulğŸ˜³</li><li>æ”¯æŒ vueï¼ŒreactJS ç­‰ç«çƒ­å‰ç«¯æ¡†æ¶</li><li>jest æ”¯æŒçš„å„ç§ APIï¼Œvitest ä¹Ÿå¯ä»¥ğŸ¤ª</li></ul><p><u>â€”â€”åšä¸»ä»¬çš„æ¨èç†ç”±</u></p><p><br></p><h2>å®‰è£… vitest</h2><p>ä»¥ vue3 ä¸ºä¾‹ï¼Œå®‰è£… vitest ä¹‹å‰éœ€è¦æœ‰ vue é¡¹ç›®â€¦â€¦</p><pre class="ql-syntax" spellcheck="false">npm install -g @vue/cli
vue create &lt;project-name&gt;
</pre><p><br></p><p>é¡¹ç›®åˆ›å»ºå¥½åï¼Œå³å¯å®‰è£… vitest</p><pre class="ql-syntax" spellcheck="false">npm install -D vitest
</pre><p><br></p><p>vitest å¯ä»¥ä½¿ç”¨ jsdom å’Œ happy-domï¼Œè¿™é‡Œä»¥ <strong>happy-dom å®‰è£…ä¸ºä¾‹</strong></p><pre class="ql-syntax" spellcheck="false">npm install @vitejs/plugin-vue @vue/test-utils happy-dom -D
</pre><p><br></p><p>å®‰è£…å®Œéœ€è¦çš„å„ç§åŒ…ï¼Œå¯ä»¥åœ¨ package.json æ–‡ä»¶ä¸‹çœ‹åˆ°åˆšåˆšçš„å®‰è£…æˆæœã€‚è¿˜å¯ä»¥<strong>åœ¨ package.json é‡Œæ·»åŠ  vitest script</strong></p><pre class="ql-syntax" spellcheck="false">  "scripts": {
    "serve": "vue-cli-service serve",
    "build": "vue-cli-service build",
    "lint": "vue-cli-service lint",
    "test": "vitest",
    "coverage": "vitest run --coverage"
  },
</pre><p>åœ¨ script æ ï¼Œæ·»åŠ  test å’Œ coverage è„šæœ¬â€¦â€¦</p><p><br></p><h2>åˆ›å»º vitest.config.js</h2><p>åœ¨é¡¹ç›®æ–‡ä»¶å¤¹ä¸‹åˆ›å»º&nbsp;vitest.config.js</p><pre class="ql-syntax" spellcheck="false">import { defineConfig } from "vitest/config"
import vue from "@vitejs/plugin-vue"

export default defineConfig({
    plugins: [vue()],
    test: {
        globals: true,
        environment: "happy-dom",
    },
    root: ".", // define the root
})
</pre><h2><br></h2><hr><p><u>ç¯å¢ƒé…ç½®å®Œæˆåï¼Œå¯ä»¥æµ‹è¯•äº†â€¦â€¦</u></p><p>ä»¥ HelloWorld ä¸ºä¾‹ï¼Œcomponent é‡Œæœ‰ HelloWorld.vueï¼Œ ä»£ç å¦‚ä¸‹ï¼š</p><pre class="ql-syntax" spellcheck="false">&lt;template&gt;
  &lt;p&gt; {{ msg }} &lt;/p&gt;
&lt;/template&gt;

&lt;script&gt;
export default {
    name: "HelloWorld",
    props: {
        message: {
            type: String,
            default: "World",
        },
    },
    setup(props) {
        return {
            msg: props.message,
        }
    }
}
&lt;/script&gt;

&lt;style&gt;
&lt;/style&gt;
</pre><p><br></p><h2>æµ‹è¯• HelloWorld Component</h2><p>åœ¨é¡¹ç›®æ–‡ä»¶ä¸‹åˆ›å»º tests æ–‡ä»¶å¤¹ï¼Œç”¨äºå­˜æ”¾å„ç§æµ‹è¯•ä»£ç â€¦â€¦</p><p>åœ¨åˆ›å»ºçš„ tests æ–‡ä»¶å¤¹ä¸‹åˆ›å»º HelloWorld.test.js â€”â€” <strong>æµ‹è¯•æ–‡ä»¶å‘½åè§„åˆ™ï¼š&lt;component name&gt;.test.js</strong></p><pre class="ql-syntax" spellcheck="false">import { mount } from "@vue/test-utils"
import HelloWorld from "../src/components/HelloWorld.vue"
import { describe, it, expect } from "vitest"

describe("HelloWorld.vue", () =&gt; {
    it("should renders is page content is correct", () =&gt; {
        const message = "Happy People"
        const testMessage = "Happy People"
        const wrapper = mount(HelloWorld, {
            props: { message }
        })
        expect(wrapper.text()).toBe(testMessage)
    })

    it("should render if props value is correct", () =&gt; {
        const message = "Happy People"
        const testMessage = "Happy People"
        const wrapper = mount(HelloWorld, {
            props: { message }
        })
        expect(wrapper.vm.message).toBe(testMessage)
    })
    
})
</pre><p><br></p><p>çœ‹çœ‹æµ‹è¯•æ•ˆæœå¦‚ä½•â€¦â€¦</p><pre class="ql-syntax" spellcheck="false">npx vitest tests/HelloWorld.test.js
</pre><p><br></p><figure class="image"><img src="https://assets.matters.news/embed/c72993f8-301b-46e2-841d-8b3e9bab4f7f.png" data-asset-id="c72993f8-301b-46e2-841d-8b3e9bab4f7f" referrerpolicy="no-referrer"><figcaption><span></span></figcaption></figure><p>HelloWorld æµ‹è¯•æ–‡ä»¶ä¸­æœ‰ä¸¤ä¸ªæµ‹è¯•æ¡ˆä¾‹ã€‚æ²¡æœ‰é—®é¢˜çš„è¯ï¼Œå°±éƒ½é€šè¿‡äº†â€¦â€¦</p><p>â€¦â€¦</p><p>â€¦â€¦</p><p>ç»§ç»­å¾€ tests æ–‡ä»¶å¤¹åˆ›å»ºä¸€ä¸€å¯¹åº”çš„æµ‹è¯•æ–‡ä»¶ã€‚</p><p>åˆ›å»ºå„ç§æµ‹è¯•æ¡ˆä¾‹ï¼Œä»€ä¹ˆ edge case ä¹‹ç±»çš„â€¦â€¦</p><p>â€¦â€¦</p><p>â€¦â€¦</p><p>æƒ³è¦ä¸€æ¬¡è·‘æ‰€æœ‰çš„æµ‹è¯•æ–‡ä»¶ï¼Œå¯ä»¥å€Ÿç”¨åˆšåˆšåœ¨ package.json åˆ›å»ºçš„ vitest è„šæœ¬</p><pre class="ql-syntax" spellcheck="false">npm run test 
</pre><p><br></p><p>ä½¿ç”¨ coverage åˆ™å¯ä»¥ç”ŸæˆæŠ¥å‘Š ğŸ˜…</p><pre class="ql-syntax" spellcheck="false"> npm run coverage
</pre><figure class="image"><img src="https://assets.matters.news/embed/39149c0b-2176-4219-9880-77b73ad6eb9f.png" data-asset-id="39149c0b-2176-4219-9880-77b73ad6eb9f" referrerpolicy="no-referrer"><figcaption><span>coverage æµ‹è¯•æˆæœâ€¦â€¦</span></figcaption></figure><p>è¿™æ—¶é¡¹ç›®æ–‡ä»¶å¤¹ä¸‹è¿˜ä¼šå¤šå‡º coerage çš„æ–‡ä»¶å¤¹ï¼Œå³æµ‹è¯•æŠ¥å‘Šçš„ç½‘é¡µç‰ˆâ€¦â€¦</p><figure class="image"><img src="https://assets.matters.news/embed/4e4fc12d-3365-4589-b5f9-e5d0f42cb833.png" data-asset-id="4e4fc12d-3365-4589-b5f9-e5d0f42cb833" referrerpolicy="no-referrer"><figcaption><span></span></figcaption></figure><p>ç½‘é¡µç‰ˆå½“ç„¶å¯ä»¥åœ¨æµè§ˆå™¨é‡ŒæŸ¥çœ‹è¯¦æƒ…â€¦â€¦éå¸¸å…ˆè¿›â€¦â€¦ğŸ¤ª</p><p><br></p><hr><p>å‚è€ƒæ–‡çŒ®ï¼š</p><p>https://www.thisdot.co/blog/getting-started-with-vue-and-vitest</p>
